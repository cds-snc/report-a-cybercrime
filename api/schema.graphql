type DailyTotal {
  date: String
  total: Int
}

"""
The DateTime scalar type represents date time strings complying to ISO-8601.
"""
scalar DateTime

type fileUploadResult {
  success: Boolean
  errorMessage: String
  md5: String
  sha1: String
  ce: String
}

type identifierFlaggingsSummary {
  identifier: String
  summaryTotal: Int
  summary: [DailyTotal]
}

type Mutation {
  """Uploads a file."""
  uploadFile(
    """File."""
    file: Upload

    """What TLP to share this at"""
    TLP: String

    """Whether or not we can share the sample itself"""
    TLPShare: Boolean

    """Can we consult with third parties?"""
    thirdPartiesAllowed: Boolean

    """Can we allow the sample to contact the internet?"""
    internetAccessAllowed: Boolean

    """Can we research the open source?"""
    openSourceAllowed: Boolean

    """Are there any additional data restrictions?"""
    dataRestrictions: Boolean

    """Specific data restrictions"""
    dataRestrictionsSpecific: String
  ): fileUploadResult

  """Flag an identifier"""
  flagIdentifier(
    """the suspects identifier (phone no, url or email)"""
    identifier: String
  ): identifierFlaggingsSummary
}

type Query {
  """Stats about report collection"""
  stats: Stats
}

type Stats {
  """The total number of reports submitted."""
  reportCount: Int

  """Daily totals for the identifier specified"""
  identifierFlaggingsWithin(
    """the suspects identifier"""
    identifier: String
  ): identifierFlaggingsSummary

  """Daily totals for the identifier specified"""
  flaggingsWithin(
    """a phone number, email address or URL"""
    identifier: String!

    """An ISO8601(YYYY-MM-DD) formatted date string"""
    startDate: DateTime!

    """An ISO8601(YYYY-MM-DD) formatted date string"""
    endDate: DateTime!
  ): identifierFlaggingsSummary
}

"""The `Upload` scalar type represents a file upload."""
scalar Upload

