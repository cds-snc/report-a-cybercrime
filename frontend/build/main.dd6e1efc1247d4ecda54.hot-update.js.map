{"version":3,"file":"main.dd6e1efc1247d4ecda54.hot-update.js","sources":["webpack:///./src/p2/forms/ScammerDetailsForm.js"],"sourcesContent":["/** @jsx jsx */\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { css, jsx } from '@emotion/core'\nimport { ApolloConsumer } from 'react-apollo'\nimport { Trans } from '@lingui/macro'\nimport { I18n } from '@lingui/react'\nimport { Form, Field } from 'react-final-form'\nimport { Container } from '../../components/container'\nimport { ButtonsContainer } from '../../components/buttons-container'\nimport { TextArea } from '../../components/text-area'\nimport { Button } from '../../components/button'\nimport { Text } from '../../components/text'\nimport { H3 } from '../../components/header'\nimport { P } from '../../components/paragraph'\nimport { Ul } from '../../components/unordered-list'\nimport { Li } from '../../components/list-item'\nimport { FileUpload } from '../../components/file-upload'\nimport { finalFormAdapter } from '../../utils/finalFormAdapter'\nimport { getScammerDetails } from '../../utils/queriesAndMutations'\nimport upload from '../../images/upload.svg'\n\nconst TextAreaAdapter = finalFormAdapter(TextArea)\n\nexport const ScammerDetailsFormWrapped = props => {\n  const { client } = props\n  const cached = getScammerDetails(client)\n  const [files, setFiles] = useState(cached.files.map(file => ({ name: file })))\n  const [fileDescriptions, setFileDescriptions] = useState(\n    cached.fileDescriptions,\n  )\n  const [scammerDetails, setScammerDetails] = useState(cached.scammerDetails)\n\n  const onChange = e => {\n    if (e.target.id === 'scammerDetails') {\n      setScammerDetails(e.target.value)\n    } else if (e.target.id.indexOf('file-description') > -1) {\n      const index = Number(e.target.id.substring(17))\n      let newFileDescriptions = JSON.parse(JSON.stringify(fileDescriptions))\n      newFileDescriptions[index] = e.target.value\n      setFileDescriptions(newFileDescriptions)\n    } else if (e.target.files && e.target.files[0]) {\n      setFiles(files.concat(e.target.files[0]))\n      setFileDescriptions(fileDescriptions.concat(''))\n    }\n  }\n\n  const removeFile = index => {\n    let newFiles = files.filter((_, fileIndex) => index != fileIndex)\n    let newFileDescriptions = fileDescriptions.filter(\n      (_, fileIndex) => index != fileIndex,\n    )\n    setFiles(newFiles)\n    setFileDescriptions(newFileDescriptions)\n  }\n\n  const localSubmit = client => {\n    const data = {\n      scammerDetails,\n      files: files.map(f => f.name),\n      fileDescriptions,\n    }\n    props.onSubmit(client, data)\n  }\n  return (\n    <ApolloConsumer>\n      {client => (\n        <Form\n          onSubmit={() => localSubmit(client)}\n          render={({ handleSubmit }) => (\n            <form onSubmit={handleSubmit}>\n              <P>\n                <Trans>\n                  <strong>\n                    Think about including things such as:\n                  </strong>\n                </Trans>\n              </P>\n              <Ul>\n                <Li>\n                  <Trans>Who the scammer claimed to be</Trans>\n                </Li>{' '}\n                <Li>\n                  <Trans>Where they requested things be sent</Trans>\n                </Li>\n                <Li>\n                  <Trans>\n                    Which email address, phone number, or website they used\n                  </Trans>\n                </Li>\n                <Li>\n                  <Trans>\n                    Any screenshots, messages, bank statements, and receipts\n                  </Trans>\n                </Li>\n              </Ul>\n              <label htmlFor=\"scammerDetails\">\n                <Text marginTop={[5, null, 6]}>\n                  <Trans>\n                    <strong>Tell us what you can about where the scam came from</strong>\n                  </Trans>\n                  <Text fontSize={(1, null, 2)}>\n                    <Trans>\n                      For example: username, address, link, language \n                    </Trans>\n                  </Text>\n                </Text>\n              </label>\n              <div>\n                <Field\n                  input={{ value: scammerDetails, onChange }}\n                  name=\"scammerDetails\"\n                  id=\"scammerDetails\"\n                  component={TextAreaAdapter}\n                  height=\"200px\"\n                />\n              </div>\n              <br></br>\n              <Container\n                marginTop={[2, null, 5]}\n                marginBottom={[2, 5, 5]}\n                display=\"flex\"\n                flexDirection=\"row\"\n                justifyContent={['flex-start', 'center', 'flex-start']}\n                textAlign=\"center\"\n              >\n                <FileUpload\n                  onChange={onChange}\n                  width={['auto', '100%', 'auto']}\n                  paddingLeft=\"1.5rem\"\n                  paddingRight=\"1.5rem\"\n                  paddingBottom=\"0.6rem\"\n                  paddingTop=\"0.6rem\"\n                  css={css`\n                    display: flex;\n                    justify-content: center;\n                    img {\n                      width: 1rem;\n                      margin-right: 0.6rem;\n                    }\n                  `}\n                >\n                  <img alt=\"upload icon\" src={upload} />\n                  <span>\n                    <Trans>Attach file</Trans>\n                  </span>\n                </FileUpload>\n              </Container>\n              <I18n>\n                {({ i18n }) => (\n                  <H3>\n                    {i18n.plural({\n                      value: files.length,\n                      one: '# file attached',\n                      other: '# files attached',\n                    })}\n                  </H3>\n                )}\n              </I18n>\n\n              <Container>\n                {files.map((f, index) => (\n                  <React.Fragment key={index}>\n                    <H3 marginTop={[4, null, 5]} fontSize={[2, null, 4]}>\n                      {f.name}\n                    </H3>\n\n                    <label htmlFor={`file-description-${index}`}>\n                      <Text>\n                        <Trans>Describe what this file shows</Trans>\n                      </Text>\n                    </label>\n                    <div>\n                      <Field\n                        input={{ value: fileDescriptions[index], onChange }}\n                        name={`file-description-${index}`}\n                        id={`file-description-${index}`}\n                        component={TextAreaAdapter}\n                        height=\"50px\"\n                      />\n                    </div>\n\n                    <Button\n                      float=\"right\"\n                      backgroundColor=\"crimson\"\n                      type=\"button\"\n                      onClick={() => removeFile(index)}\n                    >\n                      <Trans>Remove file</Trans>\n                    </Button>\n                  </React.Fragment>\n                ))}\n              </Container>\n              <ButtonsContainer\n                buttonLink={false}\n                cancel={true}\n                nextPage=\"Impact of scam\"\n              />\n            </form>\n          )}\n        />\n      )}\n    </ApolloConsumer>\n  )\n}\n\nScammerDetailsFormWrapped.propTypes = {\n  onSubmit: PropTypes.func.isRequired,\n  client: PropTypes.any.isRequired,\n}\n\nexport const ScammerDetailsForm = props => (\n  <ApolloConsumer>\n    {client => <ScammerDetailsFormWrapped client={client} {...props} />}\n  </ApolloConsumer>\n)\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;;;;;AACA;AAAA;AAEA;AACA;AAHA;AAGA;AAAA;AAAA;AAAA;AAHA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAKA;AACA;AACA;AAAA;AAEA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AAQA;AAAA;AAGA;AAAA;AAGA;AAAA;AAKA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AAQA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AALA;AAUA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAgBA;AAAA;AAAA;AAEA;AAAA;AAKA;AAAA;AAEA;AAAA;AAFA;AAYA;AACA;AAAA;AACA;AAAA;AAAA;AAIA;AAAA;AAEA;AAAA;AAKA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AALA;AAUA;AACA;AACA;AACA;AAAA;AAAA;AAJA;AAMA;AAAA;AA3BA;AAiCA;AACA;AACA;AAHA;AA5HA;AAFA;AADA;AA0IA;AAEA;AACA;AACA;AAFA;AAKA;AAAA;AAEA;AAAA;AAAA;AAAA;AAFA;;;;A","sourceRoot":""}